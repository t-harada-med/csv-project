# Data Checker 🔍

アカウント申請データとシステムエクスポートデータの照合・抽出ツールです。
Excelの申請書とシステムから出力したCSVを突き合わせ、未登録者やエラー候補を視覚的に特定し、必要なデータのみを素早く抽出します。

## ユーザーの種類について

ユーザーには４種類あります。

- **新規ユーザー**: REDCapにまったく未登録の新規ユーザー。（照合で紫🟣のIDが表示される）
- **登録済みユーザー**: 正式に登録されたユーザー。
- **完全な未登録ユーザー**: 正式登録がまだ済んでいないユーザー。仮登録のみ完了。（照合で行が赤🔴で表示される。）
- **未登録PIDありの未登録ユーザー**: 正式登録がまだ済んでいないユーザー（仮登録完了）で、過去に申請したPIDがあるユーザー。（照合で行がオレンジ🟠に表示される）


## ✨ 主な機能

- **マルチソース照合**: 申請Excel、ユーザーアカウント申請エクスポートCSV、未登録リストCSVの3つを同時に照合。

- **フィルタリング**:
    - 🟠 **オレンジ表示**: 未登録リストに存在する「未登録PIDあり」の対象。
    - 🔴 **赤表示**: 「個別登録」および「一括登録」のどちらにも存在しない完全な未登録対象。

- **新規ID採番**: ユーザーアカウント申請エクスポートCSVにないユーザー（新規ユーザー）に対して、エクスポートCSVにある record_id の最大値 + 1 から採番して画面に紫色🟣で表示。

- **スマート・エクスポート**: 照合結果から、再登録が必要な対象（新規ユーザー）のみを抽出し、アップロード用CSVとして一括出力。

## 使い方

- **1. エクスポートCSV**: REDCapの「01_ユーザーアカウント申請」プロジェクトの「レポート、データ出力、他」メニューの「全データ (全レコードとフィールド)」でエクスポートしたCSVファイルをアップロードします。

- **2. 未登録CSV**: REDCapの「01_ユーザーアカウント申請」プロジェクトの「レポート、データ出力、他」メニューの「未登録ユーザー」でエクスポートしたCSVファイルをアップロードします。

- **3. 申請書Excel**: シート「REDCap利用アカウント登録申請書」とシート「Upload」を含む申請書のエクセルファイルをアップロードします。

- **4. 照合を実行**: アップロードした３つのファイルを照合します。

- **対象のみCSV出力**: 新規ユーザーのみCSV出力します。このCSVファイルはREDCapのインポートユーザー登録で利用されます。


